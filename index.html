<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>King Dev Builderr - Ultra Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Poppins:wght@300;400;600&family=Roboto+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --scratch-blue: #4c97ff;
            --scratch-purple: #9966ff;
            --scratch-orange: #ffab19;
            --scratch-bg: #e9f0f8;
        }
        body { font-family: 'Poppins', sans-serif; height: 100vh; overflow: hidden; }
        .block-shadow { box-shadow: 0 4px 0 rgba(0,0,0,0.1); }
        .canvas-shadow { box-shadow: 0 0 50px rgba(0,0,0,0.3); }
        .sidebar-item:hover { background: rgba(76, 151, 255, 0.1); }
        #canvas::-webkit-scrollbar { width: 5px; }
        #canvas::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }
        
        /* Estilo Blocos Scratch */
        .block-logic {
            padding: 10px; margin: 8px; border-radius: 8px 20px 20px 8px;
            color: white; font-weight: bold; font-size: 13px;
            cursor: pointer; border-left: 10px solid rgba(0,0,0,0.2);
            transition: transform 0.1s;
        }
        .block-logic:active { transform: scale(0.95); }
        
        /* Resizer */
        .resizer { width: 10px; height: 10px; background: white; border: 2px solid var(--scratch-blue); position: absolute; bottom: -5px; right: -5px; cursor: nwse-resize; }
    </style>
</head>
<body class="bg-[#e9f0f8] flex flex-col">

    <header class="bg-[#4c97ff] h-12 flex items-center px-4 gap-4 text-white shadow-md z-50">
        <div class="bg-white/20 p-1 px-3 rounded-full font-bold text-sm tracking-widest">KING DEV BUILDERR</div>
        <div class="h-6 w-[1px] bg-white/30"></div>
        <button onclick="saveProject()" class="hover:bg-white/20 px-3 py-1 rounded text-xs">üíæ Salvar</button>
        <button onclick="exportCode()" class="bg-white text-[#4c97ff] px-4 py-1 rounded-full text-xs font-bold shadow-lg hover:bg-orange-400 hover:text-white transition-all">EXPORTAR .HTML</button>
        <div class="ml-auto flex items-center gap-2">
            <span class="text-[10px] opacity-70">MODO:</span>
            <span class="bg-yellow-400 text-black px-2 py-0.5 rounded text-[10px] font-black">GOD MODE</span>
        </div>
    </header>

    <main class="flex flex-1 overflow-hidden">
        
        <aside class="w-72 bg-white border-r border-gray-300 flex flex-col overflow-y-auto">
            <div class="p-4 bg-gray-50 border-bottom font-bold text-xs text-gray-400 uppercase tracking-widest">Caixa de Ferramentas</div>
            
            <div class="p-2"><span class="text-xs font-bold text-purple-600 px-2">APAR√äNCIA</span>
                <div class="block-logic bg-[#9966ff]" onclick="add('h2')">Criar T√≠tulo [PRO]</div>
                <div class="block-logic bg-[#9966ff]" onclick="add('button')">Criar Bot√£o [GAMER]</div>
                <div class="block-logic bg-[#9966ff]" onclick="add('div')">Criar Container [GLASS]</div>
                <div class="block-logic bg-[#9966ff]" onclick="add('img')">Inserir Imagem [URL]</div>
            </div>

            <div class="p-2"><span class="text-xs font-bold text-orange-500 px-2">EVENTOS & L√ìGICA</span>
                <div class="block-logic bg-[#ffab19]" onclick="addLogic('link')">Se clicado -> Ir para p√°gina</div>
                <div class="block-logic bg-[#ffab19]" onclick="addLogic('alert')">Se clicado -> Mostrar Alerta</div>
            </div>

            <div class="p-2"><span class="text-xs font-bold text-blue-500 px-2">CONECTIVIDADE (EXTERNO)</span>
                <div class="block-logic bg-[#4c97ff]" onclick="addExternal('discord')">Embed Discord [API]</div>
                <div class="block-logic bg-[#4c97ff]" onclick="addExternal('video')">Player YouTube [BG]</div>
            </div>
        </aside>

        <section class="flex-1 bg-[#f9f9f9] flex flex-col p-6 overflow-y-auto relative">
            <div id="welcome-msg" class="absolute inset-0 flex flex-col items-center justify-center opacity-20 pointer-events-none">
                <i data-lucide="layout" class="w-32 h-32 mb-4"></i>
                <h2 class="text-2xl font-bold">√ÅREA DE SCRIPT</h2>
                <p>Arraste um bloco para come√ßar a buildar</p>
            </div>

            <div id="inspector" class="hidden animate-in slide-in-from-right duration-300">
                <div class="bg-white p-6 rounded-2xl shadow-xl border border-gray-200 w-full max-w-md">
                    <h3 class="font-black text-gray-800 mb-4 flex items-center gap-2">
                        <i data-lucide="settings-2" class="text-purple-600"></i> CONFIGURA√á√ïES DO OBJETO
                    </h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="text-[10px] font-bold text-gray-400">TEXTO OU LINK</label>
                            <input type="text" id="prop-text" oninput="update()" class="w-full bg-gray-100 border-none p-2 rounded-lg text-sm">
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-[10px] font-bold text-gray-400">LARGURA (PX)</label>
                                <input type="number" id="prop-w" oninput="update()" class="w-full bg-gray-100 border-none p-2 rounded-lg text-sm">
                            </div>
                            <div>
                                <label class="text-[10px] font-bold text-gray-400">ALTURA (PX)</label>
                                <input type="number" id="prop-h" oninput="update()" class="w-full bg-gray-100 border-none p-2 rounded-lg text-sm">
                            </div>
                        </div>

                        <div>
                            <label class="text-[10px] font-bold text-gray-400">ESTILO DE FONTE</label>
                            <select id="prop-font" onchange="update()" class="w-full bg-gray-100 border-none p-2 rounded-lg text-sm">
                                <option value="'Poppins'">Poppins (Clean)</option>
                                <option value="'Montserrat'">Montserrat (Bold)</option>
                                <option value="'Roboto Mono'">Roboto Mono (Hacker)</option>
                            </select>
                        </div>

                        <div class="flex items-center gap-4">
                            <div class="flex-1">
                                <label class="text-[10px] font-bold text-gray-400">COR FUNDO</label>
                                <input type="color" id="prop-bg" oninput="update()" class="w-full h-10 border-none rounded-lg cursor-pointer">
                            </div>
                            <div class="flex-1">
                                <label class="text-[10px] font-bold text-gray-400">COR TEXTO</label>
                                <input type="color" id="prop-color" oninput="update()" class="w-full h-10 border-none rounded-lg cursor-pointer">
                            </div>
                        </div>

                        <div>
                            <label class="text-[10px] font-bold text-gray-400">GLOW / BRILHO (Z-AXIS)</label>
                            <input type="range" id="prop-glow" min="0" max="50" oninput="update()" class="w-full accent-purple-600">
                        </div>

                        <button onclick="removeElement()" class="w-full py-2 bg-red-50 text-red-500 rounded-lg text-xs font-bold hover:bg-red-500 hover:text-white transition-all">REMOVER ELEMENTO</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="w-[450px] bg-white border-l border-gray-300 flex flex-col items-center">
            <div class="w-full p-2 bg-gray-50 flex justify-between px-4 border-b">
                <span class="text-[10px] font-bold text-gray-400">STAGE (IPHONE 15 PRO)</span>
                <div class="flex gap-1">
                    <div class="w-2 h-2 rounded-full bg-red-400"></div>
                    <div class="w-2 h-2 rounded-full bg-yellow-400"></div>
                    <div class="w-2 h-2 rounded-full bg-green-400"></div>
                </div>
            </div>

            <div class="flex-1 flex items-center justify-center w-full bg-gray-200">
                <div id="canvas" class="bg-white w-[375px] h-[750px] relative canvas-shadow overflow-hidden rounded-[40px] border-[8px] border-gray-800">
                    </div>
            </div>

            <div class="w-full h-48 bg-white border-t border-gray-300 p-4">
                <span class="text-[10px] font-black text-gray-400">SPRITES / CAMADAS</span>
                <div id="sprite-list" class="flex gap-2 mt-2 overflow-x-auto pb-2">
                    </div>
            </div>
        </section>
    </main>

    <script>
        lucide.createIcons();

        let state = {
            selectedId: null,
            elements: [],
            pages: ['Home'],
            currentPage: 'Home'
        };

        function add(type) {
            const el = {
                id: 'king-' + Date.now(),
                type: type,
                text: type === 'button' ? 'CLIQUE AQUI' : 'Novo T√≠tulo King',
                x: 40, y: 100, w: 280, h: 55,
                bg: type === 'button' ? '#4c97ff' : '#f3f4f6',
                color: type === 'button' ? '#ffffff' : '#1e293b',
                font: 'Poppins',
                glow: 0,
                radius: 15,
                logic: null
            };
            state.elements.push(el);
            select(el.id);
            render();
        }

        function render() {
            const canvas = document.getElementById('canvas');
            const spriteList = document.getElementById('sprite-list');
            canvas.innerHTML = '';
            spriteList.innerHTML = '';

            state.elements.forEach(el => {
                // Render Canvas
                const div = document.createElement(el.type === 'button' ? 'button' : 'div');
                div.id = el.id;
                div.className = `absolute element flex items-center justify-center transition-all ${state.selectedId === el.id ? 'ring-4 ring-purple-500 ring-offset-2' : ''}`;
                div.style.cssText = `
                    left: ${el.x}px; top: ${el.y}px; width: ${el.w}px; height: ${el.h}px;
                    background: ${el.bg}; color: ${el.color}; font-family: ${el.font};
                    border-radius: ${el.radius}px; font-weight: bold; font-size: 14px;
                    box-shadow: 0 ${el.glow/2}px ${el.glow}px ${el.bg}66;
                    cursor: move; border: none; overflow: hidden;
                `;
                
                if(el.type === 'img') {
                    div.innerHTML = `<img src="${el.text}" class="w-full h-full object-cover">`;
                } else {
                    div.innerText = el.text;
                }

                div.onmousedown = (e) => dragStart(e, el);
                canvas.appendChild(div);

                // Render Sprites List (Igual Scratch)
                const sprite = document.createElement('div');
                sprite.className = `min-w-[70px] h-[70px] rounded-xl border-2 flex flex-col items-center justify-center text-[8px] font-bold cursor-pointer transition-all ${state.selectedId === el.id ? 'border-purple-500 bg-purple-50' : 'border-gray-100 bg-gray-50'}`;
                sprite.innerHTML = `<div class="w-8 h-8 rounded bg-gray-300 mb-1"></div>${el.type.toUpperCase()}`;
                sprite.onclick = () => select(el.id);
                spriteList.appendChild(sprite);
            });
        }

        function select(id) {
            state.selectedId = id;
            const el = state.elements.find(e => e.id === id);
            document.getElementById('welcome-msg').style.display = 'none';
            document.getElementById('inspector').style.display = 'block';
            
            document.getElementById('prop-text').value = el.text;
            document.getElementById('prop-w').value = el.w;
            document.getElementById('prop-h').value = el.h;
            document.getElementById('prop-bg').value = el.bg;
            document.getElementById('prop-color').value = el.color;
            document.getElementById('prop-glow').value = el.glow;
            render();
        }

        function update() {
            const el = state.elements.find(e => e.id === state.selectedId);
            el.text = document.getElementById('prop-text').value;
            el.w = parseInt(document.getElementById('prop-w').value);
            el.h = parseInt(document.getElementById('prop-h').value);
            el.bg = document.getElementById('prop-bg').value;
            el.color = document.getElementById('prop-color').value;
            el.font = document.getElementById('prop-font').value;
            el.glow = document.getElementById('prop-glow').value;
            render();
        }

        function dragStart(e, el) {
            select(el.id);
            let rect = canvas.getBoundingClientRect();
            let shiftX = e.clientX - rect.left - el.x;
            let shiftY = e.clientY - rect.top - el.y;

            document.onmousemove = (e) => {
                el.x = e.clientX - rect.left - shiftX;
                el.y = e.clientY - rect.top - shiftY;
                render();
            };
            document.onmouseup = () => document.onmousemove = null;
        }

        function removeElement() {
            state.elements = state.elements.filter(e => e.id !== state.selectedId);
            state.selectedId = null;
            document.getElementById('inspector').style.display = 'none';
            document.getElementById('welcome-msg').style.display = 'flex';
            render();
        }

        function exportCode() {
            const html = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Build by King Dev</title>
                    <script src="https://cdn.tailwindcss.com"><\/script>
                    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap" rel="stylesheet">
                    <style>body { margin: 0; overflow-x: hidden; font-family: 'Poppins'; }</style>
                </head>
                <body class="bg-gray-100 flex justify-center">
                    <div class="w-[375px] h-screen bg-white relative overflow-hidden shadow-2xl">
                        ${state.elements.map(el => {
                            const style = `position:absolute; left:${el.x}px; top:${el.y}px; width:${el.w}px; height:${el.h}px; background:${el.bg}; color:${el.color}; border-radius:${el.radius}px; display:flex; align-items:center; justify-content:center; box-shadow: 0 ${el.glow/4}px ${el.glow}px ${el.bg}66; border:none; cursor:pointer;`;
                            return `<${el.type === 'button' ? 'button' : 'div'} style="${style}">${el.text}</${el.type === 'button' ? 'button' : 'div'}>`;
                        }).join('')}
                    </div>
                </body>
                </html>
            `;
            const blob = new Blob([html], {type: 'text/html'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'king_project_ultra.html';
            a.click();
        }

        function saveProject() {
            localStorage.setItem('king_project', JSON.stringify(state));
            alert("Projeto salvo no navegador!");
        }

        // Carregar se existir
        const saved = localStorage.getItem('king_project');
        if(saved) {
            state = JSON.parse(saved);
            render();
        }
    </script>
</body>
</html>
