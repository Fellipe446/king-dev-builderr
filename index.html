<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>King Dev Builderr - Scratch Mode</title>
    <style>
        :root { --scratch-orange: #ffab19; --scratch-blue: #4c97ff; --scratch-purple: #9966ff; --bg: #e9f0f8; --panel: #ffffff; }
        body { margin: 0; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background: var(--bg); color: #575e75; overflow: hidden; display: flex; flex-direction: column; height: 100vh; }
        
        /* Header Estilo Scratch */
        header { background: var(--scratch-blue); color: white; padding: 10px 20px; display: flex; align-items: center; gap: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .logo { font-weight: bold; font-size: 20px; background: rgba(0,0,0,0.1); padding: 5px 15px; border-radius: 20px; }
        .nav-btn { background: none; border: 1px solid white; color: white; padding: 5px 15px; border-radius: 15px; cursor: pointer; }
        .nav-btn:hover { background: white; color: var(--scratch-blue); }

        main { display: flex; flex: 1; overflow: hidden; }

        /* Coluna de Blocos (Componentes) */
        #blocks-panel { width: 250px; background: var(--panel); border-right: 1px solid #d9d9d9; display: flex; flex-direction: column; }
        .block-category { padding: 15px; font-weight: bold; border-bottom: 1px solid #eee; font-size: 14px; }
        .scratch-block { 
            background: var(--scratch-blue); color: white; padding: 8px 12px; margin: 10px; border-radius: 4px; 
            cursor: pointer; font-size: 13px; font-weight: bold; border-left: 10px solid #2e76db;
            transition: 0.2s; user-select: none;
        }
        .scratch-block.event { background: var(--scratch-orange); border-left-color: #cf8b11; }
        .scratch-block:active { transform: scale(0.95); }

        /* 츼rea Central (Script/Config) */
        #script-area { flex: 1; background: #f9f9f9; padding: 20px; overflow-y: auto; }
        .inspector-card { background: white; border: 1px solid #d9d9d9; border-radius: 8px; padding: 15px; margin-bottom: 15px; }

        /* 츼rea do Palco (Preview) */
        #stage-area { width: 420px; background: #ffffff; border-left: 1px solid #d9d9d9; display: flex; flex-direction: column; align-items: center; padding-top: 20px; }
        #canvas { 
            width: 320px; height: 568px; background: white; border: 2px solid #d9d9d9; border-radius: 10px;
            position: relative; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }

        /* Lista de Sprites (Elementos) */
        #sprites-list { height: 150px; background: white; border-top: 1px solid #d9d9d9; display: flex; padding: 10px; gap: 10px; overflow-x: auto; }
        .sprite-item { 
            width: 80px; height: 80px; border: 2px solid #eee; border-radius: 8px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-size: 10px; cursor: pointer; background: #fdfdfd;
        }
        .sprite-item.active { border-color: var(--scratch-blue); background: #eef5ff; }

        /* Elementos no Canvas */
        .element { position: absolute; cursor: move; }
        .selected-outline { outline: 2px solid var(--scratch-blue) !important; }

        /* Home Screen Overlap */
        #home-screen { 
            position: fixed; inset: 0; background: var(--scratch-blue); z-index: 1000; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; color: white;
        }
    </style>
</head>
<body>

<div id="home-screen">
    <h1>KING DEV BUILDERR</h1>
    <p>Crie sites arrastando blocos, igual ao Scratch!</p>
    <button class="nav-btn" style="font-size: 20px; padding: 15px 40px;" onclick="startNewProject()">Criar Novo Projeto</button>
</div>

<header>
    <div class="logo">King Scratch</div>
    <button class="nav-btn" onclick="location.reload()">In칤cio</button>
    <button class="nav-btn" onclick="exportCode()">Exportar para .HTML</button>
    <div id="project-name" style="margin-left: auto;">Projeto: Sem Nome</div>
</header>

<main>
    <div id="blocks-panel">
        <div class="block-category" style="color: var(--scratch-blue)">MOVIMENTO / UI</div>
        <div class="scratch-block" onclick="addElement('button')">adicione um [Bot칚o]</div>
        <div class="scratch-block" onclick="addElement('h2')">adicione um [T칤tulo]</div>
        <div class="scratch-block" onclick="addElement('div')">adicione uma [Caixa]</div>
        
        <div class="block-category" style="color: var(--scratch-orange)">EVENTOS / L칍GICA</div>
        <div class="scratch-block event">quando clicado -> v치 para [P치gina]</div>
    </div>

    <div id="script-area">
        <div id="no-selection-msg">Selecione um elemento ou adicione um novo para configurar.</div>
        <div id="inspector" style="display:none">
            <h3 id="ins-title">Configurar Elemento</h3>
            <div class="inspector-card">
                <label>Texto/Conte칰do:</label><br>
                <input type="text" id="p-text" oninput="updateProp()" style="width:100%">
            </div>
            <div class="inspector-card" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px">
                <div><label>X:</label><input type="number" id="p-x" oninput="updateProp()"></div>
                <div><label>Y:</label><input type="number" id="p-y" oninput="updateProp()"></div>
            </div>
            <div class="inspector-card">
                <label>Cor de Fundo:</label>
                <input type="color" id="p-bg" oninput="updateProp()">
            </div>
            <div class="inspector-card">
                <label>A칞칚o: Quando clicado, v치 para:</label>
                <select id="p-link" onchange="updateProp()"></select>
            </div>
            <button onclick="deleteCurrent()" style="color:red; border:none; background:none; cursor:pointer">Excluir Elemento</button>
        </div>
    </div>

    <div id="stage-area">
        <div style="margin-bottom: 10px; font-weight: bold;">Palco (Mobile Preview)</div>
        <div id="canvas"></div>
        <div style="margin-top:20px; width:100%">
            <div style="padding: 0 20px; font-size: 12px; font-weight: bold;">ELEMENTOS (SPRITES)</div>
            <div id="sprites-list"></div>
        </div>
    </div>
</main>

<script>
    let project = {
        name: "Meu Site Scratch",
        pages: { page1: { title: "Home", elements: [] } },
        currentPage: 'page1',
        selectedId: null
    };

    function startNewProject() {
        project.name = prompt("Nome do Projeto:", "Site do King") || "Sem Nome";
        document.getElementById('project-name').innerText = "Projeto: " + project.name;
        document.getElementById('home-screen').style.display = 'none';
        updatePageSelectors();
        render();
    }

    function addElement(type) {
        const el = {
            id: 'el-' + Date.now(),
            type: type,
            text: type === 'button' ? 'Clique Aqui' : 'Texto',
            x: 20, y: 20, w: 150, h: 45,
            bg: type === 'button' ? '#4c97ff' : '#ffffff',
            color: type === 'button' ? '#ffffff' : '#000000',
            link: ''
        };
        project.pages[project.currentPage].elements.push(el);
        selectElement(el.id);
        render();
    }

    function render() {
        const canvas = document.getElementById('canvas');
        const sprites = document.getElementById('sprites-list');
        canvas.innerHTML = '';
        sprites.innerHTML = '';

        project.pages[project.currentPage].elements.forEach(el => {
            // Desenha no Canvas
            const div = document.createElement('div');
            div.className = `element ${project.selectedId === el.id ? 'selected-outline' : ''}`;
            div.style.cssText = `left:${el.x}px; top:${el.y}px; width:${el.w}px; height:${el.h}px; background:${el.bg}; color:${el.color}; position:absolute; border-radius:5px; display:flex; align-items:center; justify-content:center; font-size:12px; font-weight:bold; box-shadow: 0 2px 4px rgba(0,0,0,0.1);`;
            div.innerText = el.text;
            
            div.onmousedown = (e) => dragStart(e, el);
            canvas.appendChild(div);

            // Adiciona na lista de Sprites embaixo
            const item = document.createElement('div');
            item.className = `sprite-item ${project.selectedId === el.id ? 'active' : ''}`;
            item.innerHTML = `<span style="font-size:20px">${el.type === 'button' ? '游댖' : '游늯'}</span><span>${el.type}</span>`;
            item.onclick = () => selectElement(el.id);
            sprites.appendChild(item);
        });
    }

    function selectElement(id) {
        project.selectedId = id;
        const el = project.pages[project.currentPage].elements.find(e => e.id === id);
        document.getElementById('no-selection-msg').style.display = 'none';
        document.getElementById('inspector').style.display = 'block';
        
        document.getElementById('p-text').value = el.text;
        document.getElementById('p-x').value = el.x;
        document.getElementById('p-y').value = el.y;
        document.getElementById('p-bg').value = el.bg;
        document.getElementById('p-link').value = el.link;
        render();
    }

    function updateProp() {
        const el = project.pages[project.currentPage].elements.find(e => e.id === project.selectedId);
        el.text = document.getElementById('p-text').value;
        el.x = parseInt(document.getElementById('p-x').value);
        el.y = parseInt(document.getElementById('p-y').value);
        el.bg = document.getElementById('p-bg').value;
        el.link = document.getElementById('p-link').value;
        render();
    }

    function dragStart(e, el) {
        selectElement(el.id);
        let rect = canvas.getBoundingClientRect();
        let shiftX = e.clientX - rect.left - el.x;
        let shiftY = e.clientY - rect.top - el.y;

        document.onmousemove = (e) => {
            el.x = e.clientX - rect.left - shiftX;
            el.y = e.clientY - rect.top - shiftY;
            render();
            document.getElementById('p-x').value = el.x;
            document.getElementById('p-y').value = el.y;
        };
        document.onmouseup = () => document.onmousemove = null;
    }

    function updatePageSelectors() {
        const sel = document.getElementById('p-link');
        sel.innerHTML = '<option value="">(Vazio)</option>';
        // Aqui voc칡 pode adicionar l칩gica para criar mais p치ginas igual ao Scratch cria novos Backdrops
        sel.innerHTML += '<option value="page2">Nova P치gina</option>';
    }

    function exportCode() {
        // L칩gica de exporta칞칚o similar  anterior
        alert("Gerando c칩digo do seu projeto Scratch...");
        // Reutilize a fun칞칚o de exporta칞칚o da V2.1 aqui
    }

    function deleteCurrent() {
        project.pages[project.currentPage].elements = project.pages[project.currentPage].elements.filter(e => e.id !== project.selectedId);
        project.selectedId = null;
        document.getElementById('inspector').style.display = 'none';
        document.getElementById('no-selection-msg').style.display = 'block';
        render();
    }
</script>
</body>
</html>
